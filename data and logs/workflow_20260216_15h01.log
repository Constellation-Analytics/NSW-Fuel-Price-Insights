2026-02-16 15:01:17 - INFO -   Orchestrator   - Starting orchestrator
2026-02-16 15:01:17 - INFO -   Orchestrator   - Starting modules/1.file_retrieval.py
2026-02-16 15:01:17 - INFO -      Module      - connecting to https://data.nsw.gov.au/data/dataset/fuel-check
2026-02-16 15:01:21 - INFO -      Module      - jan2026 data file already loaded
2026-02-16 15:01:21 - INFO -   Orchestrator   - Conditions not met in modules/1.file_retrieval.py - Skipping Module
2026-02-16 15:01:21 - INFO -   Orchestrator   - Starting modules/2.transform_data.py
2026-02-16 15:01:22 - INFO -      Module      - jan2026 file has already been transformed
2026-02-16 15:01:22 - INFO -   Orchestrator   - Conditions not met in modules/2.transform_data.py - Skipping Module
2026-02-16 15:01:22 - INFO -   Orchestrator   - Starting modules/3.api_integration.py
2026-02-16 15:01:22 - INFO -      Module      - Pulling API Information
2026-02-16 15:01:26 - INFO -      Module      - Pulling Database Information
2026-02-16 15:01:27 - INFO -      Module      - Creating the datasets
2026-02-16 15:01:27 - INFO -      Module      - Truncate the staging tables
2026-02-16 15:01:27 - INFO -      Module      - Inserting data into the database
2026-02-16 15:01:27 - ERROR -      Module      - Unexpected error while inserting values into database: (psycopg2.errors.InvalidSchemaName) schema "dev" does not exist
LINE 2: CREATE TABLE dev.staging_inactive_stations (
                     ^

[SQL: 
CREATE TABLE dev.staging_inactive_stations (
	stationid TEXT, 
	brand TEXT, 
	name TEXT, 
	address TEXT, 
	street TEXT, 
	town TEXT, 
	postcode TEXT, 
	latitude FLOAT(53), 
	longitude FLOAT(53), 
	last_update DATE
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidSchemaName: schema "dev" does not exist
LINE 2: CREATE TABLE dev.staging_inactive_stations (
                     ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/NSW-Fuel-Price-Insights/NSW-Fuel-Price-Insights/modules/3.api_integration.py", line 262, in <module>
    deleted.to_sql('staging_inactive_stations', connection, schema='dev', if_exists='append', index=False)
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/pandas/core/generic.py", line 3052, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/pandas/io/sql.py", line 841, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/pandas/io/sql.py", line 2027, in to_sql
    table = self.prep_table(
            ^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/pandas/io/sql.py", line 1932, in prep_table
    table.create()
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/pandas/io/sql.py", line 999, in create
    self._execute_create()
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/pandas/io/sql.py", line 983, in _execute_create
    self.table.create(bind=self.pd_sql.con)
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 1288, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2467, in _run_ddl_visitor
    ).traverse_single(element)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 661, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 1022, in visit_table
    )._invoke_with(self.connection)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 321, in _invoke_with
    return bind.execute(self)
           ^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidSchemaName) schema "dev" does not exist
LINE 2: CREATE TABLE dev.staging_inactive_stations (
                     ^

[SQL: 
CREATE TABLE dev.staging_inactive_stations (
	stationid TEXT, 
	brand TEXT, 
	name TEXT, 
	address TEXT, 
	street TEXT, 
	town TEXT, 
	postcode TEXT, 
	latitude FLOAT(53), 
	longitude FLOAT(53), 
	last_update DATE
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2026-02-16 15:01:27 - INFO -      Module      - Config file updated
2026-02-16 15:01:27 - ERROR -      Module      - Unexpected error saving json config file: name 'push_file_to_repo' is not defined
Traceback (most recent call last):
  File "/home/runner/work/NSW-Fuel-Price-Insights/NSW-Fuel-Price-Insights/modules/3.api_integration.py", line 161, in save_config
    push_file_to_repo(config_file, f"successful run - configfile updated {datetimestamp}")
    ^^^^^^^^^^^^^^^^^
NameError: name 'push_file_to_repo' is not defined
2026-02-16 15:01:27 - INFO -      Module      - Operation complete
2026-02-16 15:01:27 - INFO -   Orchestrator   - Finished modules/3.api_integration.py
2026-02-16 15:01:27 - INFO -   Orchestrator   - Starting modules/99.retention_policy.py
2026-02-16 15:01:28 - INFO - Retention Policy - Old workflow logs cleaned up and changes pushed.
2026-02-16 15:01:28 - INFO -   Orchestrator   - Finished modules/99.retention_policy.py
2026-02-16 15:01:28 - INFO -   Orchestrator   - Finished orchestrator
